# php5-fpm - The PHP FastCGI Process Manager

description "The PHP FastCGI Process Manager"
author "Rodrigo Tomonari Muino <rodrigo.tomonari@gmail.com>"

start on runlevel [2345]
stop on runlevel [016]

pre-start script
	errors=$(/usr/sbin/php5-fpm --fpm-config /etc/php5/fpm/php5-fpm-DOMAIN.conf -t 2>&1 | grep "\[ERROR\]" || true);
	if [ -n "$errors" ]; then
		stop 
		exit 0
	fi
end script

respawn

exec /usr/sbin/php5-fpm --nodaemonize --fpm-config /etc/php5/fpm/php5-fpm-DOMAIN.conf
